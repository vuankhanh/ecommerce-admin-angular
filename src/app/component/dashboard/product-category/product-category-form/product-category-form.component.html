@if(formGroup){
<app-header-page-container (goBack)="goBackProducCategoryDetail()"></app-header-page-container>
<mat-card>
  <mat-card-content>
    <div class="horizontal-container">
      <form [formGroup]="formGroup" class="vertical-container">
        <!-- Nhóm tên danh mục sản phẩm đa ngôn ngữ -->
        <fieldset>
          <legend>Tên danh mục sản phẩm</legend>
          <div class="multi-lang-fields" formGroupName="name">
            <mat-form-field>
              <mat-label>Tiếng Việt (VI)</mat-label>
              <input matInput placeholder="Tên tiếng Việt" formControlName="vi" required>
              <mat-error *ngIf="formGroup.get('name.vi')?.hasError('required')">
                Bắt buộc nhập tên tiếng Việt
              </mat-error>
              <mat-error *ngIf="formGroup.get('name.vi')?.hasError('minlength')">
                Tên sản phẩm phải có ít nhất 1 ký tự
              </mat-error>
              <mat-error *ngIf="formGroup.get('name.vi')?.hasError('maxlength')">
                Tên sản phẩm không được quá 100 ký tự
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Tiếng Anh (EN)</mat-label>
              <input matInput placeholder="Tên tiếng Anh" formControlName="en">
              <mat-error *ngIf="formGroup.get('name.en')?.hasError('required')">
                Bắt buộc nhập tên tiếng Anh
              </mat-error>
              <mat-error *ngIf="formGroup.get('name.en')?.hasError('minlength')">
                Tên sản phẩm phải có ít nhất 1 ký tự
              </mat-error>
              <mat-error *ngIf="formGroup.get('name.en')?.hasError('maxlength')">
                Tên sản phẩm không được quá 100 ký tự
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Tiếng Nhật (JA)</mat-label>
              <input matInput placeholder="Tên tiếng Nhật" formControlName="ja">
              <mat-error *ngIf="formGroup.get('name.ja')?.hasError('required')">
                Bắt buộc nhập tên tiếng Nhật
              </mat-error>
              <mat-error *ngIf="formGroup.get('name.ja')?.hasError('minlength')">
                Tên sản phẩm phải có ít nhất 1 ký tự
              </mat-error>
              <mat-error *ngIf="formGroup.get('name.ja')?.hasError('maxlength')">
                Tên sản phẩm không được quá 100 ký tự
              </mat-error>
            </mat-form-field>
          </div>
        </fieldset>

        <fieldset>
          <legend>Mô tả chi tiết</legend>
          <div class="multi-lang-fields" formGroupName="description">
            <mat-form-field>
              <mat-label>Tiếng Việt (VI)</mat-label>
              <textarea matInput placeholder="Mô tả tiếng Việt" formControlName="vi" cdkTextareaAutosize
                cdkAutosizeMinRows="3" cdkAutosizeMaxRows="9" required></textarea>
              <mat-error *ngIf="formGroup.get('description.vi')?.hasError('required')">
                Mô tả tiếng Việt là bắt buộc
              </mat-error>
              <mat-error *ngIf="formGroup.get('description.vi')?.hasError('minlength')">
                Mô tả phải có ít nhất 10 ký tự
              </mat-error>
              <mat-error *ngIf="formGroup.get('description.vi')?.hasError('maxlength')">
                Mô tả không được quá 1000 ký tự
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Tiếng Anh (EN)</mat-label>
              <textarea matInput placeholder="Mô tả tiếng Anh" formControlName="en" cdkTextareaAutosize
                cdkAutosizeMinRows="3" cdkAutosizeMaxRows="9"></textarea>
              <mat-error *ngIf="formGroup.get('description.en')?.hasError('required')">
                Mô tả tiếng Anh là bắt buộc
              </mat-error>
              <mat-error *ngIf="formGroup.get('description.en')?.hasError('minlength')">
                Mô tả phải có ít nhất 10 ký tự
              </mat-error>
              <mat-error *ngIf="formGroup.get('description.en')?.hasError('maxlength')">
                Mô tả không được quá 1000 ký tự
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Tiếng Nhật (JA)</mat-label>
              <textarea matInput placeholder="Mô tả tiếng Nhật" formControlName="ja" cdkTextareaAutosize
                cdkAutosizeMinRows="3" cdkAutosizeMaxRows="9"></textarea>
              <mat-error *ngIf="formGroup.get('description.ja')?.hasError('required')">
                Mô tả tiếng Nhật là bắt buộc
              </mat-error>
              <mat-error *ngIf="formGroup.get('description.ja')?.hasError('minlength')">
                Mô tả phải có ít nhất 10 ký tự
              </mat-error>
              <mat-error *ngIf="formGroup.get('description.ja')?.hasError('maxlength')">
                Mô tả không được quá 1000 ký tự
              </mat-error>
            </mat-form-field>
          </div>
        </fieldset>

        <mat-form-field appearance="fill">
          <mat-label>Danh mục Cha</mat-label>
          <input #productCategoryEl type="text" matInput [matAutocomplete]="productCategoryElAuto"
            (blur)="onProductCategoryBlur($event)">
          <mat-icon matSuffix>category</mat-icon>
          <mat-autocomplete #productCategoryElAuto="matAutocomplete"
            (optionSelected)="onCategoryOptionSelected($event)">
            @for (productCategory of productCategory$ | async; track productCategory) {
            <mat-option [value]="productCategory">{{productCategory.name}}</mat-option>
            }
          </mat-autocomplete>
          <mat-error *ngIf="formGroup.get('parentId')?.hasError('required')">
            Danh mục là bắt buộc
          </mat-error>
        </mat-form-field>

        <section>
          <mat-checkbox formControlName="isActive">
            Kích hoạt
          </mat-checkbox>
        </section>
      </form>

      <section class="album-container">
        <app-choose-media-product-category [mediaId]="formGroup.get('albumId')?.value"
          (mediaProductCategoryEmit)="handleMediaProductCategory($event)"></app-choose-media-product-category>
      </section>
    </div>
  </mat-card-content>
  <mat-card-actions>
    @if (productCategory?._id) {
    <button mat-raised-button color="primary" type="button" (click)="onSubmit()"
      [disabled]="formGroup.invalid || !(isFormChanged$ | async)">
      Lưu
    </button>
    }@else {
    <button mat-raised-button color="primary" type="button" (click)="onSubmit()" [disabled]="formGroup.invalid ">
      Tạo
    </button>
    }
  </mat-card-actions>
</mat-card>
}